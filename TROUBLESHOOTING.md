# 调酒师酒吧管理系统故障排除指南

## 📋 目录

1. [常见问题快速解决](#1-常见问题快速解决)
2. [页面空白问题](#2-页面空白问题)
3. [登录问题](#3-登录问题)
4. [系统启动问题](#4-系统启动问题)
5. [网络连接问题](#5-网络连接问题)
6. [数据保存问题](#6-数据保存问题)
7. [性能问题](#7-性能问题)
8. [调试工具使用](#8-调试工具使用)

---

## 1. 常见问题快速解决

### 🚀 快速检查清单

在深入排查前，请先检查以下基本项目：

- ✅ 服务器是否正在运行？
- ✅ 网络连接是否正常？
- ✅ 浏览器是否为最新版本？
- ✅ 是否已正确登录？
- ✅ 浏览器控制台是否有错误信息？

### 🔧 万能重启大法

90%的问题可以通过重启解决：

1. **刷新页面**：`Ctrl + F5` (强制刷新)
2. **重启浏览器**：完全关闭后重新打开
3. **重启服务器**：停止服务后重新启动
4. **清除缓存**：清除浏览器缓存和Cookie

---

## 2. 页面空白问题

### 问题描述
点击"配方管理"或其他页面按钮后，页面显示空白。

## 排查步骤

### 1. 检查用户登录状态
1. 打开浏览器开发者工具 (F12)
2. 在Console中输入以下命令：
```javascript
console.log('用户状态:', localStorage.getItem('user'));
console.log('Token状态:', localStorage.getItem('token'));
```
3. 如果返回null，请先访问 http://localhost:5173/login 登录
4. 使用默认账号：用户名 `admin`，密码 `admin123`

### 2. 检查JavaScript错误
1. 在开发者工具的Console标签页中查看是否有红色错误信息
2. 如果有错误，记录错误信息
3. 常见错误类型：
   - 模块导入错误
   - API调用失败
   - 组件渲染错误

### 3. 检查网络请求
1. 在开发者工具的Network标签页中
2. 刷新页面，查看是否有失败的请求（红色状态）
3. 特别关注API请求（通常以/api开头）

### 4. 检查React组件状态
1. 在Console中输入：
```javascript
// 检查React DevTools是否可用
window.__REACT_DEVTOOLS_GLOBAL_HOOK__
```
2. 如果安装了React DevTools扩展，可以查看组件状态

### 5. 查看调试日志
我已经在Recipes组件中添加了详细的调试日志，请在Console中查看以下信息：
- 🔄 Recipes组件开始加载数据...
- 📡 开始调用API...
- 📡 API响应: ...
- ✅ API调用成功，设置配方数据: ...
- ⚠️ API调用失败，使用模拟数据
- ❌ 加载配方失败: ...
- 📋 设置模拟配方数据: ...
- ✅ 数据加载完成，设置loading为false
- 🎯 Recipes组件渲染状态: ...

### 6. 临时解决方案
如果问题持续存在，可以临时使用测试页面：
1. 访问 http://localhost:5173/dashboard
2. 或者直接修改URL为其他页面进行测试

## 常见问题及解决方案

### 问题1：用户未登录
**症状**：页面重定向到登录页面
**解决**：使用 admin/admin123 登录

### 问题2：API服务未启动
**症状**：Console显示网络错误或404错误
**解决**：确保后端服务正在运行（端口3001）

### 问题3：组件渲染错误
**症状**：ErrorBoundary显示错误页面
**解决**：查看错误详情，通常是组件代码问题

### 问题4：样式加载失败
**症状**：页面布局混乱或无样式
**解决**：检查Tailwind CSS是否正确加载

## 技术细节

### 已添加的调试功能
1. **错误边界组件**：捕获JavaScript运行时错误
2. **详细日志**：追踪数据加载过程
3. **测试组件**：验证路由和基本渲染

### 系统架构
- 前端：React + TypeScript + Vite + Tailwind CSS
- 路由：React Router v6
- 状态管理：React Context (AuthContext)
- API：Axios + Express后端

---

## 3. 登录问题

### 问题1：无法登录
**症状**：输入用户名密码后提示登录失败
**解决步骤**：
1. 确认用户名：`admin`
2. 确认密码：`admin123`
3. 检查后端服务是否启动
4. 查看网络请求是否成功

### 问题2：登录后自动退出
**症状**：登录成功但立即跳转回登录页
**解决步骤**：
1. 检查Token是否正确保存
2. 清除浏览器缓存
3. 检查Token过期时间设置

---

## 4. 系统启动问题

### 问题1：npm start 失败
```bash
# 错误：Cannot find module
解决方案：
rm -rf node_modules package-lock.json
npm install
npm start
```

### 问题2：端口被占用
```bash
# 错误：Port 5173 is already in use
解决方案：
# 查找占用端口的进程
lsof -ti:5173
# 杀死进程
kill -9 <PID>
# 或者使用不同端口
npm run dev -- --port 5174
```

### 问题3：依赖版本冲突
```bash
# 清理并重新安装
npm cache clean --force
rm -rf node_modules package-lock.json
npm install
```

---

## 5. 网络连接问题

### API请求失败
**检查步骤**：
1. 确认后端服务运行在 `http://localhost:3001`
2. 检查防火墙设置
3. 验证CORS配置
4. 查看网络请求状态码

### 跨域问题
**解决方案**：
1. 检查后端CORS配置
2. 确认前端API基础URL设置
3. 使用代理配置（如需要）

---

## 6. 数据保存问题

### 配方保存失败
**排查步骤**：
1. 检查必填字段是否完整
2. 验证数据格式是否正确
3. 查看后端日志错误信息
4. 确认数据库连接正常

### 库存更新失败
**可能原因**：
1. 数据验证失败
2. 数据库锁定
3. 权限不足
4. 网络中断

---

## 7. 性能问题

### 页面加载缓慢
**优化建议**：
1. 清除浏览器缓存
2. 检查网络连接速度
3. 关闭不必要的浏览器标签
4. 重启浏览器

### 内存占用过高
**解决方案**：
1. 重启浏览器
2. 关闭开发者工具
3. 清理系统内存
4. 检查是否有内存泄漏

---

## 8. 调试工具使用

### 浏览器开发者工具

**打开方式**：
- Windows/Linux: `F12` 或 `Ctrl + Shift + I`
- macOS: `Cmd + Option + I`

**主要功能**：
1. **Console**：查看错误信息和日志
2. **Network**：监控网络请求
3. **Elements**：检查HTML和CSS
4. **Application**：查看本地存储

### React DevTools

**安装**：
- Chrome: 搜索"React Developer Tools"扩展
- Firefox: 搜索"React Developer Tools"插件

**使用**：
1. 查看组件树结构
2. 检查组件状态
3. 监控性能

### 常用调试命令

```javascript
// 检查用户登录状态
console.log('用户状态:', localStorage.getItem('user'));
console.log('Token状态:', localStorage.getItem('token'));

// 检查React版本
console.log('React版本:', React.version);

// 清除本地存储
localStorage.clear();
sessionStorage.clear();

// 重新加载页面
window.location.reload();
```

---

## 🆘 获取技术支持

### 自助排查
1. 查看本指南相关章节
2. 搜索错误信息
3. 查看系统日志
4. 尝试重现问题

### 联系支持
如果问题仍未解决，请提供以下信息：

**基本信息**：
- 操作系统版本
- 浏览器类型和版本
- Node.js版本
- 问题发生时间

**错误信息**：
- 浏览器Console完整错误日志
- Network标签页失败请求详情
- 后端服务器日志（如有）
- 问题复现的详细步骤

**截图**：
- 错误界面截图
- 开发者工具截图
- 相关配置截图

---

*最后更新时间：2024年1月*
*文档版本：v2.0*